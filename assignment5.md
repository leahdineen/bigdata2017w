CS 489 Big Data Assignment 5
============================

Q1:
ANSWER=266
Verfied on linux and altiscale

Q2:
(Clerk#000000803,2309)
(Clerk#000000222,2595)
(Clerk#000000327,4773)
(Clerk#000000215,9381)
(Clerk#000000319,17189)
(Clerk#000000842,17600)
(Clerk#000000050,18372)
(Clerk#000000605,19462)
(Clerk#000000769,22149)
(Clerk#000000757,22210)
(Clerk#000000189,22982)
(Clerk#000000159,26176)
(Clerk#000000940,26308)
(Clerk#000000458,26311)
(Clerk#000000181,27271)
(Clerk#000000628,29383)
(Clerk#000000297,32069)
(Clerk#000000297,32069)
(Clerk#000000100,33734)
(Clerk#000000462,37703)

+---------------+----------+
|        o_clerk|o_orderkey|
+---------------+----------+
|Clerk#000000803|      2309|
|Clerk#000000222|      2595|
|Clerk#000000327|      4773|
|Clerk#000000215|      9381|
|Clerk#000000319|     17189|
|Clerk#000000842|     17600|
|Clerk#000000050|     18372|
|Clerk#000000605|     19462|
|Clerk#000000769|     22149|
|Clerk#000000757|     22210|
|Clerk#000000189|     22982|
|Clerk#000000159|     26176|
|Clerk#000000940|     26308|
|Clerk#000000458|     26311|
|Clerk#000000181|     27271|
|Clerk#000000628|     29383|
|Clerk#000000297|     32069|
|Clerk#000000297|     32069|
|Clerk#000000100|     33734|
|Clerk#000000462|     37703|
+---------------+----------+

Q3:
(2309,burnished orchid rose rosy tomato,Supplier#000000519)
(2595,purple floral green slate smoke,Supplier#000000675)
(4773,turquoise yellow wheat salmon dim,Supplier#000000315)
(9381,turquoise blush indian moccasin burlywood,Supplier#000000020)
(17189,lavender green chocolate pink peach,Supplier#000000561)
(17600,chartreuse snow saddle ghost medium,Supplier#000000968)
(18372,navy black coral rose papaya,Supplier#000000641)
(19462,royal steel lime purple light,Supplier#000000679)
(22149,sienna snow frosted cornflower blush,Supplier#000000655)
(22210,bisque tan coral blue salmon,Supplier#000000740)
(22982,blanched ghost burlywood rose white,Supplier#000000377)
(26176,medium royal puff sky saddle,Supplier#000000182)
(26308,midnight ivory gainsboro slate khaki,Supplier#000000905)
(26311,frosted orange seashell lemon chartreuse,Supplier#000000437)
(27271,bisque steel azure blush linen,Supplier#000000861)
(29383,goldenrod saddle plum chiffon lawn,Supplier#000000409)
(32069,cornsilk medium midnight coral mint,Supplier#000000867)
(32069,coral rose puff chiffon green,Supplier#000000991)
(33734,powder smoke aquamarine midnight grey,Supplier#000000166)
(37703,chartreuse plum orchid violet lavender,Supplier#000000187)

+----------+--------------------+------------------+
|l_orderkey|              p_name|            s_name|
+----------+--------------------+------------------+
|      2309|burnished orchid ...|Supplier#000000519|
|      2595|purple floral gre...|Supplier#000000675|
|      4773|turquoise yellow ...|Supplier#000000315|
|      9381|turquoise blush i...|Supplier#000000020|
|     17189|lavender green ch...|Supplier#000000561|
|     17600|chartreuse snow s...|Supplier#000000968|
|     18372|navy black coral ...|Supplier#000000641|
|     19462|royal steel lime ...|Supplier#000000679|
|     22149|sienna snow frost...|Supplier#000000655|
|     22210|bisque tan coral ...|Supplier#000000740|
|     22982|blanched ghost bu...|Supplier#000000377|
|     26176|medium royal puff...|Supplier#000000182|
|     26308|midnight ivory ga...|Supplier#000000905|
|     26311|frosted orange se...|Supplier#000000437|
|     27271|bisque steel azur...|Supplier#000000861|
|     29383|goldenrod saddle ...|Supplier#000000409|
|     32069|coral rose puff c...|Supplier#000000991|
|     32069|cornsilk medium m...|Supplier#000000867|
|     33734|powder smoke aqua...|Supplier#000000166|
|     37703|chartreuse plum o...|Supplier#000000187|
+----------+--------------------+------------------+


Q4:

(0,ALGERIA,5)
(1,ARGENTINA,8)
(2,BRAZIL,15)
(3,CANADA,12)
(4,EGYPT,8)
(5,ETHIOPIA,6)
(6,FRANCE,9)
(7,GERMANY,17)
(8,INDIA,8)
(9,INDONESIA,13)
(10,IRAN,14)
(11,IRAQ,13)
(12,JAPAN,19)
(13,JORDAN,14)
(14,KENYA,7)
(15,MOROCCO,10)
(16,MOZAMBIQUE,9)
(17,PERU,8)
(18,CHINA,4)
(19,ROMANIA,21)

+-----------+----------+--------+
|n_nationkey|    n_name|count(1)|
+-----------+----------+--------+
|          0|   ALGERIA|       5|
|          1| ARGENTINA|       8|
|          2|    BRAZIL|      15|
|          3|    CANADA|      12|
|          4|     EGYPT|       8|
|          5|  ETHIOPIA|       6|
|          6|    FRANCE|       9|
|          7|   GERMANY|      17|
|          8|     INDIA|       8|
|          9| INDONESIA|      13|
|         10|      IRAN|      14|
|         11|      IRAQ|      13|
|         12|     JAPAN|      19|
|         13|    JORDAN|      14|
|         14|     KENYA|       7|
|         15|   MOROCCO|      10|
|         16|MOZAMBIQUE|       9|ยก
|         17|      PERU|       8|
|         18|     CHINA|       4|
|         19|   ROMANIA|      21|
+-----------+----------+--------+

Q5:

Q6:

1996-01-01
+------------+------------+-------+-----------------+-----------------+-----------------+-----------------+-----------------+-------------------+-----------+
|l_returnflag|l_linestatus|sum_qty|   sum_base_price|   sum_disc_price|       sum_charge|          avg_qty|        avg_price|           avg_disc|count_order|
+------------+------------+-------+-----------------+-----------------+-----------------+-----------------+-----------------+-------------------+-----------+
|           N|           O| 7050.0|9670322.449999997|9158295.638400001|9535800.642212005|26.50375939849624|36354.59567669172|0.05274436090225562|        266|
+------------+------------+-------+-----------------+-----------------+-----------------+-----------------+-----------------+-------------------+-----------+
Text
(N,O,7050.0,9670322.449999996,9158295.638400003,9535800.642212,26.50375939849624,36354.595676691715,0.052744360902255615,266)
Parquet
(N,O,7050.0,9670322.449999997,9158295.638400001,9535800.642212005,26.50375939849624,36354.59567669172,0.05274436090225562,266)

MAYBE TRY A DIFFERENT DATA TYPE WITH MORE PRECISION (ALONG THE LINES OF BIG INT)


1994-07-04
+------------+------------+-------+-----------------+-----------------+-----------------+------------------+-----------------+-------------------+-----------+
|l_returnflag|l_linestatus|sum_qty|   sum_base_price|   sum_disc_price|       sum_charge|           avg_qty|        avg_price|           avg_disc|count_order|
+------------+------------+-------+-----------------+-----------------+-----------------+------------------+-----------------+-------------------+-----------+
|           A|           F| 3077.0|4266098.339999998|4051550.246999998|    4206823.42408|24.228346456692915|33591.32551181101|0.04874015748031491|        127|
|           R|           F| 3033.0|4313708.400000002|4103560.746200001|4269808.941440001|        23.6953125|33700.84687500002|0.04742187499999996|        128|
+------------+------------+-------+-----------------+-----------------+-----------------+------------------+-----------------+-------------------+-----------+
Text
(A,F,3077.0,4266098.34,4051550.2470000004,4206823.42408,24.228346456692915,33591.325511811025,0.04874015748031496,127)
(R,F,3033.0,4313708.4,4103560.746199999,4269808.941439999,23.6953125,33700.846875,0.047421875,128)
Parquet
(A,F,3077.0,4266098.339999998,4051550.246999998,4206823.42408,24.228346456692915,33591.32551181101,0.04874015748031491,127)
(R,F,3033.0,4313708.400000002,4103560.746200001,4269808.941440001,23.6953125,33700.84687500002,0.04742187499999996,128)

Q7:

+------------------+----------+------------------+-----------+--------------+
|            c_name|l_orderkey|           revenue|o_orderdate|o_shippriority|
+------------------+----------+------------------+-----------+--------------+
|Customer#000009068|    504452|       427070.9956| 1995-12-28|             0|
|Customer#000001013|    208450|       392056.5682| 1995-11-23|             0|
|Customer#000014521|      5925| 391698.6805000001| 1995-11-13|             0|
|Customer#000006160|    145089|       383905.1472| 1995-12-06|             0|
|Customer#000002149|     92039|       372060.5709| 1995-12-24|             0|
|Customer#000012259|    315269|       336969.9039| 1995-12-29|             0|
|Customer#000005623|    176769|324073.67519999994| 1995-12-21|             0|
|Customer#000003803|    381152|323319.28719999996| 1995-11-30|             0|
|Customer#000011183|    399459|       321395.2656| 1995-12-13|             0|
|Customer#000005935|    539456|320125.29409999994| 1995-12-18|             0|
+------------------+----------+------------------+-----------+--------------+
(Customer#000009068,504452,427070.9956,1995-12-28,0)
(Customer#000001013,208450,392056.5682,1995-11-23,0)
(Customer#000014521,5925,391698.6805,1995-11-13,0)
(Customer#000006160,145089,383905.14719999995,1995-12-06,0)
(Customer#000002149,92039,372060.5709,1995-12-24,0)
(Customer#000012259,315269,336969.9039,1995-12-29,0)
(Customer#000005623,176769,324073.6752,1995-12-21,0)
(Customer#000003803,381152,323319.2872,1995-11-30,0)
(Customer#000011183,399459,321395.2656,1995-12-13,0)
(Customer#000005935,539456,320125.29410000006,1995-12-18,0)

(Customer#000009068,504452,427070.9956,1995-12-28,0)
(Customer#000001013,208450,392056.5682,1995-11-23,0)
(Customer#000014521,5925,391698.6805,1995-11-13,0)
(Customer#000006160,145089,383905.14719999995,1995-12-06,0)
(Customer#000002149,92039,372060.5709,1995-12-24,0)
(Customer#000012259,315269,336969.9039,1995-12-29,0)
(Customer#000005623,176769,324073.6752,1995-12-21,0)
(Customer#000003803,381152,323319.2872,1995-11-30,0)
(Customer#000011183,399459,321395.2656,1995-12-13,0)
(Customer#000005935,539456,320125.29410000006,1995-12-18,0)
